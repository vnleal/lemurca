<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>PapaParse</title>
  </head>
  <body>
  	<header class="container">
  		<div class="row">
  			<div class="col-12 my-3"><h1>Votación en Elección de Presidente 2021</h1></div>
  		</div>
  	</header>
    <main class="container">
    	<div class="row d-flex align-items-center">
    		<div class="col-4"><h3 class="fs-5">Regiones</h3></div>
    		<div class="col-8"><p class="d-flex justify-content-between align-items-center small"><span class="text-success">⬤ Boric</span> <span class="text-primary">⬤ Kast</span> <span class="text-danger">⬤ Provoste</span>  <span class="text-warning">⬤ Sichel</span> <span class="text-dark">⬤ Artés</span> <span class="text-secondary">⬤ MEO</span> <span class="text-info">⬤ Parisi</span></p>
    		</div>
    	</div>
    	<div id="aqui" class="border-bottom"></div>
	</main>
	<footer class="container">
  		<div class="row">
  			<div class="col-12 mt-5">
  				<p>Para armar lo que parece un <a href="https://datavizcatalogue.com/ES/metodos/grafico_de_barras_apiladas.html">gráfico de barras apiladas</a>, sólo utilizamos <a href="https://getbootstrap.com/docs/5.1/components/progress/">la clase de <code>.progress</code> de Bootstrap</a>. El color de cada elemento se ajusta a <a href="https://getbootstrap.com/docs/5.1/customize/color/">los colores que ofrece Bootstrap</a> por defecto.</p>
  				<p>Los datos los obtenemos de <a href="https://raw.githubusercontent.com/profesorfaco/infografia/main/clase-4/dato_preliminar_servel.csv">un CSV que está en línea</a>. Para ir a buscar y procesar tales datos (en tal formato), se utiliza <a href="https://www.papaparse.com/">PapaParse</a>, una Biblioteca de JavaScript.</p>
  			</div>
  			<div class="col-12 my-5">
  				<cite class="small">Fuente: <a href="https://preliminares.servelelecciones.cl/" target="_blank">Resultados Preliminares Servel</a> de Votación en Elección de Presidente 2021. Consultado el 30 de noviembre, 2021.</cite>
  			</div>
  		</div>
  	</footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.1/papaparse.min.js" integrity="sha512-EbdJQSugx0nVWrtyK3JdQQ/03mS3Q1UiAhRtErbwl1YL/+e2hZdlIcSURxxh7WXHTzn83sjlh2rysACoJGfb6g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
    	Papa.parse("https://raw.githubusercontent.com/profesorfaco/infografia/main/clase-4/dato_preliminar_servel.csv", {
    		download: true,
    		header: true,
    		complete: function(results) {
    			var datos = results.data;
    			console.log(datos);
    			const donde = document.getElementById("aqui");
    			datos.forEach(d=>{
    				donde.innerHTML += '<div class="row border-top d-flex align-items-center small py-2"><div class="col-4">'+d.region+'</div><div class="col-8"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: '+d.boric+'%"></div><div class="progress-bar bg-primary" role="progressbar" style="width: '+d.kast+'%"></div><div class="progress-bar bg-danger" role="progressbar" style="width: '+d.provoste+'%"></div><div class="progress-bar bg-warning" role="progressbar" style="width: '+d.sichel+'%"></div><div class="progress-bar bg-dark" role="progressbar" style="width: '+d.artes+'%"></div><div class="progress-bar bg-secondary" role="progressbar" style="width: '+d.meo+'%"></div><div class="progress-bar bg-info" role="progressbar" style="width: '+d.parisi+'%"></div></div>' +'</div></div>';
    			})
    		}
    	});
    </script>
  </body>
</html>